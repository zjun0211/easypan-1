import{u as P}from"./vue-clipboard3-69020072.js";import{u as j,b as q}from"./vue-router-8555237b.js";import{_ as z}from"./index-ca90e5e8.js";import{j as F,r,ag as _,o as s,c as p,a as o,V as b,P as f,T as g,O as v,F as k,S as m,U as x,bh as U,bf as H}from"./@vue-57ff52f9.js";import"./clipboard-0f4a3daa.js";import"./aplayer-585df14e.js";import"./pinia-00fcc55c.js";import"./spark-md5-66a43a5d.js";import"./element-plus-ef3483b5.js";import"./lodash-es-36eb724a.js";import"./@vueuse-7d05ada6.js";import"./@element-plus-b7409ee9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-5d216acc.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./escape-html-9626137c.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-880a26aa.js";import"./vue-cookies-fc2d14d9.js";import"./@highlightjs-b4f50377.js";import"./highlight.js-6845818c.js";import"./axios-4a70c6fc.js";import"./docx-preview-6a55e1c1.js";import"./jszip-057f312d.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-d49914df.js";import"./vue-60347265.js";import"./vue3-pdfjs-749e1b4f.js";import"./pdfjs-dist-dcaaa779.js";import"./dommatrix-b4915c8e.js";import"./web-streams-polyfill-ab743aaf.js";import"./dplayer-d4a41b2a.js";const A=n=>(U("data-v-8dfc0301"),n=n(),H(),n),G={class:"top"},J=A(()=>o("span",{class:"iconfont icon-cancel"},null,-1)),K={class:"file-list"},Q=["onMouseenter","onMouseleave"],W=["title"],X={class:"op"},Y=["onClick"],Z=["onClick"],ee={__name:"Share",setup(n){const{toClipboard:C}=P(),{proxy:i}=F();j(),q();const y={loadDataList:"/share/loadShareList",cancelShare:"/share/cancelShare"},I=r(document.location.origin+"/share/"),N=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"分享时间",prop:"shareTime",width:200},{label:"失效时间",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"浏览次数",prop:"showCount",width:200}],c=r({}),O={extHeight:20,selectType:"checkbox"},S=async()=>{let t={pageNo:c.value.pageNo,pageSize:c.value.pageSize};t.category!=="all"&&delete t.filePid;let a=await i.Request({url:y.loadDataList,params:t});a&&(c.value=a.data)},$=t=>{c.value.list.forEach(a=>{a.showOp=!1}),t.showOp=!0},D=t=>{t.showOp=!1},L=async t=>{await C(`链接:${I.value}${t.shareId} 提取码: ${t.code}`),i.Message.success("复制成功")},l=r([]),M=t=>{l.value=[],t.forEach(a=>{l.value.push(a.shareId)})},u=r([]),R=()=>{l.value.length!=0&&(u.value=l.value,T())},B=t=>{u.value=[t.shareId],T()},T=async()=>{i.Confirm("你确定要取消分享吗？",async()=>{await i.Request({url:y.cancelShare,params:{shareIds:u.value.join(",")}})&&(i.Message.success("取消分享成功"),S())})};return(t,a)=>{const V=_("el-button"),d=_("icon"),w=_("Table");return s(),p("div",null,[o("div",G,[b(V,{type:"primary",disabled:l.value.length==0,onClick:R},{default:f(()=>[J,g("取消分享 ")]),_:1},8,["disabled"])]),o("div",K,[b(w,{columns:N,showPagination:!0,dataSource:c.value,fetch:S,options:O,onRowSelected:M},{fileName:f(({index:E,row:e})=>[o("div",{class:"file-item",onMouseenter:h=>$(e),onMouseleave:h=>D(e)},[(e.fileType==3||e.fileType==1)&&e.status!==0?(s(),v(d,{key:0,cover:e.fileCover},null,8,["cover"])):(s(),p(k,{key:1},[e.folderType==0?(s(),v(d,{key:0,fileType:e.fileType},null,8,["fileType"])):m("",!0),e.folderType==1?(s(),v(d,{key:1,fileType:0})):m("",!0)],64)),e.showRename?m("",!0):(s(),p("span",{key:2,class:"file-name",title:e.fileName},[o("span",null,x(e.fileName),1)],8,W)),o("span",X,[e.showOp&&e.fileId?(s(),p(k,{key:0},[o("span",{class:"iconfont icon-link",onClick:h=>L(e)},"复制链接",8,Y),o("span",{class:"iconfont icon-cancel",onClick:h=>B(e)},"取消分享",8,Z)],64)):m("",!0)])],40,Q)]),expireTime:f(({index:E,row:e})=>[g(x(e.validType==3?"永久":e.expireTime),1)]),_:1},8,["dataSource"])])])}}},Ve=z(ee,[["__scopeId","data-v-8dfc0301"]]);export{Ve as default};
