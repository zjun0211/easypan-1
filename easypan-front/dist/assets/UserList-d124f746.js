import{j as K,r as m,ag as l,o as x,c as k,a as d,V as e,P as a,a3 as V,a9 as P,T as v,U as b,u as C,S as D,n as E}from"./@vue-57ff52f9.js";import{u as H,b as G}from"./vue-router-8555237b.js";import{_ as J}from"./index-ca90e5e8.js";import"./pinia-00fcc55c.js";import"./spark-md5-66a43a5d.js";import"./aplayer-585df14e.js";import"./element-plus-ef3483b5.js";import"./lodash-es-36eb724a.js";import"./@vueuse-7d05ada6.js";import"./@element-plus-b7409ee9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-5d216acc.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./escape-html-9626137c.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-880a26aa.js";import"./vue-cookies-fc2d14d9.js";import"./@highlightjs-b4f50377.js";import"./highlight.js-6845818c.js";import"./axios-4a70c6fc.js";import"./docx-preview-6a55e1c1.js";import"./jszip-057f312d.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-d49914df.js";import"./vue-60347265.js";import"./vue3-pdfjs-749e1b4f.js";import"./pdfjs-dist-dcaaa779.js";import"./dommatrix-b4915c8e.js";import"./web-streams-polyfill-ab743aaf.js";import"./dplayer-d4a41b2a.js";import"./vue-clipboard3-69020072.js";import"./clipboard-0f4a3daa.js";const Q={class:"top-panel"},W={class:"file-list"},X={class:"avatar"},Y={key:0,style:{color:"#529b2e"}},Z={key:1,style:{color:"#f56c6c"}},ee=["onClick"],te=["onClick"],ae={__name:"UserList",setup(oe){const{proxy:r}=K();H(),G();const S={loadDataList:"/admin/loadUserList",updateUserStatus:"/admin/updateUserStatus",updateUserSpace:"/admin/updateUserSpace"},N=[{label:"头像",prop:"avatar",width:80,scopedSlots:"avatar"},{label:"昵称",prop:"nickName"},{label:"邮箱",prop:"email"},{label:"空间使用",prop:"space",scopedSlots:"space"},{label:"加入时间",prop:"joinTime"},{label:"最后登录时间",prop:"lastLoginTime"},{label:"状态",prop:"status",scopedSlots:"status",width:80},{label:"操作",prop:"op",width:150,scopedSlots:"op"}],i=m({}),_=m({}),T={extHeight:20},c=async()=>{let o={pageNo:_.value.pageNo,pageSize:_.value.pageSize};Object.assign(o,i.value);let t=await r.Request({url:S.loadDataList,params:o});t&&(_.value=t.data)},z=o=>{r.Confirm(`你确定要【${o.status==0?"启动":"禁用"}】吗？`,async()=>{await r.Request({url:S.updateUserStatus,params:{userId:o.userId,status:o.status==0?1:0}})&&c()})},p=m({show:!1,title:"修改空间大小",buttons:[{type:"primary",text:"确定",click:o=>{R()}}]}),u=m({}),g=m(),L={changeSpace:[{required:!0,message:"请输入空间大小"}]},I=o=>{p.value.show=!0,E(()=>{g.value.resetFields(),u.value=Object.assign({},o)})},R=()=>{g.value.validate(async o=>{if(!o)return;let t={};Object.assign(t,u.value),await r.Request({url:S.updateUserSpace,params:t})&&(p.value.show=!1,r.Message.success("操作成功"),c())})};return(o,t)=>{const h=l("el-input"),f=l("el-form-item"),y=l("el-col"),U=l("el-option"),q=l("el-select"),j=l("el-button"),F=l("el-row"),w=l("el-form"),B=l("Avatar"),M=l("el-divider"),O=l("Table"),$=l("Dialog");return x(),k("div",null,[d("div",Q,[e(w,{model:i.value,"label-width":"80px",onSubmit:t[2]||(t[2]=V(()=>{},["prevent"]))},{default:a(()=>[e(F,null,{default:a(()=>[e(y,{span:4},{default:a(()=>[e(f,{label:"用户昵称"},{default:a(()=>[e(h,{clearable:"",placeholder:"支持模糊搜索",modelValue:i.value.nickNameFuzzy,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value.nickNameFuzzy=n),modelModifiers:{trim:!0},onKeyup:P(c,["native"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(y,{span:4},{default:a(()=>[e(f,{label:"状态"},{default:a(()=>[e(q,{clearable:"",placeholder:"请选择状态",modelValue:i.value.status,"onUpdate:modelValue":t[1]||(t[1]=n=>i.value.status=n)},{default:a(()=>[e(U,{value:1,label:"启用"}),e(U,{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:4,style:{"padding-left":"10px"}},{default:a(()=>[e(j,{type:"primary",onClick:c},{default:a(()=>[v(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),d("div",W,[e(O,{columns:N,showPagination:!0,dataSource:_.value,fetch:c,options:T},{avatar:a(({index:n,row:s})=>[d("div",X,[e(B,{userId:s.userId,avatar:s.qqAvatar},null,8,["userId","avatar"])])]),space:a(({index:n,row:s})=>[v(b(C(r).Utils.sizeToStr(s.useSpace))+"/"+b(C(r).Utils.sizeToStr(s.totalSpace)),1)]),status:a(({index:n,row:s})=>[s.status==1?(x(),k("span",Y,"启用")):D("",!0),s.status==0?(x(),k("span",Z,"禁用")):D("",!0)]),op:a(({index:n,row:s})=>[d("span",{class:"a-link",onClick:A=>I(s)},"分配空间",8,ee),e(M,{direction:"vertical"}),d("span",{class:"a-link",onClick:A=>z(s)},b(s.status==0?"启用":"禁用"),9,te)]),_:1},8,["dataSource"])]),e($,{show:p.value.show,title:p.value.title,buttons:p.value.buttons,width:"400px",showCancel:!1,onClose:t[5]||(t[5]=n=>p.value.show=!1)},{default:a(()=>[e(w,{model:u.value,rules:L,ref_key:"formDataRef",ref:g,"label-width":"80px",onSubmit:t[4]||(t[4]=V(()=>{},["prevent"]))},{default:a(()=>[e(f,{label:"昵称"},{default:a(()=>[v(b(u.value.nickName),1)]),_:1}),e(f,{label:"空间大小",prop:"changeSpace"},{default:a(()=>[e(h,{clearable:"",placeholder:"请输入空间大小",modelValue:u.value.changeSpace,"onUpdate:modelValue":t[3]||(t[3]=n=>u.value.changeSpace=n)},{suffix:a(()=>[v("MB")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}},Be=J(ae,[["__scopeId","data-v-f4e624f4"]]);export{Be as default};
